import{_ as r,r as t,o as d,c as i,a as e,b as o,w as l,d as n,e as c}from"./app-3yLlkFXl.js";const p={},u=e("h1",{id:"部署node-js-app服務到-google-cloud-run",tabindex:"-1"},[e("a",{class:"header-anchor",href:"#部署node-js-app服務到-google-cloud-run","aria-hidden":"true"},"#"),n(" 部署node.js app服務到 Google Cloud Run")],-1),h={class:"table-of-contents"},g=c(`<p>之前使用的Heroku託管的node.js app服務已經終止免費方案，這次嘗試將line-bot這包執行在Cloud Run。</p><h2 id="使用google-cloud-cli" tabindex="-1"><a class="header-anchor" href="#使用google-cloud-cli" aria-hidden="true">#</a> 使用Google Cloud CLI</h2><p>參照官方教學，在下載好Cloud CLI後要執行install.sh腳本來安裝。 <img src="https://i.imgur.com/BmCTrHO.png" alt=""></p><div class="language-shell= line-numbers-mode" data-ext="shell="><pre class="language-shell="><code>sh install.sh
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div></div></div><h2 id="對應執行app服務的npm腳本" tabindex="-1"><a class="header-anchor" href="#對應執行app服務的npm腳本" aria-hidden="true">#</a> 對應執行app服務的npm腳本</h2><p>在官方範例中，是預設<strong>npm run start</strong>來執行。所以在專案中的package.json中，需要加上如下。</p><div class="language-json line-numbers-mode" data-ext="json"><pre class="language-json"><code><span class="token punctuation">{</span>
    ...<span class="token punctuation">,</span>
  <span class="token property">&quot;scripts&quot;</span><span class="token operator">:</span> <span class="token punctuation">{</span>
    <span class="token property">&quot;start&quot;</span><span class="token operator">:</span> <span class="token string">&quot;node index.js&quot;</span> <span class="token comment">//進入點的js</span>
  <span class="token punctuation">}</span><span class="token punctuation">,</span>
<span class="token punctuation">}</span>
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><h2 id="添加dockerfile的配置" tabindex="-1"><a class="header-anchor" href="#添加dockerfile的配置" aria-hidden="true">#</a> 添加Dockerfile的配置</h2><p>在官網文件中，並沒有明確提示要配置，但在實際部署後會有錯誤提示有關無法對應到部署後的8080port。目前猜測是Cloud Run的部署預設是走Docker Container的方式，要訪問會需要先有Docker Image的配置。</p><p><img src="https://i.imgur.com/idFaf6t.png" alt=""></p><h2 id="在專案目錄執行cli部署指令" tabindex="-1"><a class="header-anchor" href="#在專案目錄執行cli部署指令" aria-hidden="true">#</a> 在專案目錄執行CLI部署指令</h2><ul><li><p>初始化：需要在Google Cloud Run後台先建立專案</p></li><li><p>部署：會有一個對應的問答(服務名稱、選擇部署區域)</p></li></ul><div class="language-bash line-numbers-mode" data-ext="sh"><pre class="language-bash"><code>gcloud init <span class="token comment">## 初始化</span>

gcloud run deploy <span class="token comment">## 部署</span>
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div>`,13),m={href:"https://cloud.google.com/run/docs/deploying-source-code?hl=zh-cn",target:"_blank",rel:"noopener noreferrer"},_=e("strong",null,"其他部署方式",-1),f=e("h2",{id:"救活的豆皮頻道",tabindex:"-1"},[e("a",{class:"header-anchor",href:"#救活的豆皮頻道","aria-hidden":"true"},"#"),n(" 救活的豆皮頻道")],-1),b={href:"https://line-bot-dopee-zhy7lseifa-an.a.run.app/",target:"_blank",rel:"noopener noreferrer"},k={href:"https://console.cloud.google.com/run/detail/asia-northeast1/line-bot-dopee/metrics?project=line-bot-380902",target:"_blank",rel:"noopener noreferrer"},v=e("h2",{id:"相關資源",tabindex:"-1"},[e("a",{class:"header-anchor",href:"#相關資源","aria-hidden":"true"},"#"),n(" 相關資源")],-1),C={href:"https://github.com/GoogleCloudPlatform/nodejs-docs-samples/tree/4000d1a341cbfcec12cc433c10b11d3fbd1a59df/run/helloworld",target:"_blank",rel:"noopener noreferrer"},x={href:"https://cloud.google.com/run/docs/quickstarts/build-and-deploy/deploy-nodejs-service?hl=zh-cn#whats-next",target:"_blank",rel:"noopener noreferrer"},j={href:"https://cloud.google.com/sdk/docs/install",target:"_blank",rel:"noopener noreferrer"};function I(R,y){const a=t("router-link"),s=t("ExternalLinkIcon");return d(),i("div",null,[u,e("nav",h,[e("ul",null,[e("li",null,[o(a,{to:"#使用google-cloud-cli"},{default:l(()=>[n("使用Google Cloud CLI")]),_:1})]),e("li",null,[o(a,{to:"#對應執行app服務的npm腳本"},{default:l(()=>[n("對應執行app服務的npm腳本")]),_:1})]),e("li",null,[o(a,{to:"#添加dockerfile的配置"},{default:l(()=>[n("添加Dockerfile的配置")]),_:1})]),e("li",null,[o(a,{to:"#在專案目錄執行cli部署指令"},{default:l(()=>[n("在專案目錄執行CLI部署指令")]),_:1})]),e("li",null,[o(a,{to:"#救活的豆皮頻道"},{default:l(()=>[n("救活的豆皮頻道")]),_:1})]),e("li",null,[o(a,{to:"#相關資源"},{default:l(()=>[n("相關資源")]),_:1})])])]),g,e("p",null,[n("這裡的指令還有相關參數可以配合"),e("a",m,[_,o(s)]),n("使用。")]),f,e("p",null,[e("a",b,[n("https://line-bot-dopee-zhy7lseifa-an.a.run.app/"),o(s)])]),e("p",null,[e("a",k,[n("Cloud Run監控服務的後台"),o(s)])]),v,e("p",null,[e("a",C,[n("部署node.js GCR官方範例程式碼"),o(s)])]),e("p",null,[e("a",x,[n("部署node.js GCR官方文件"),o(s)])]),e("p",null,[e("a",j,[n("安裝gcloud CLI"),o(s)])])])}const q=r(p,[["render",I],["__file","googleCloudRun.html.vue"]]);export{q as default};
