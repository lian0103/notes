import{_ as n,o as s,c as a,e as t}from"./app.c19253c6.js";const p={},e=t(`<h1 id="\u532F\u51FA-excel-\u6307\u5B9A\u5132\u5B58\u8DEF\u5F91" tabindex="-1"><a class="header-anchor" href="#\u532F\u51FA-excel-\u6307\u5B9A\u5132\u5B58\u8DEF\u5F91" aria-hidden="true">#</a> \u532F\u51FA excel&amp;\u6307\u5B9A\u5132\u5B58\u8DEF\u5F91</h1><h2 id="xlsx-\u5957\u4EF6-browser-file-system-access-api-showsavefilepicker" tabindex="-1"><a class="header-anchor" href="#xlsx-\u5957\u4EF6-browser-file-system-access-api-showsavefilepicker" aria-hidden="true">#</a> xlsx \u5957\u4EF6 &amp; browser File System Access API (showSaveFilePicker)</h2><p>xlsx \u5957\u4EF6\u751F\u6210 excel \u7684\u4ECB\u7D39\u90E8\u5206\u7701\u7565(\u4E4B\u524D\u5BEB\u904E)\u3002\u5728\u539F\u672C\u627E\u7684\u7BC4\u4F8B\u4E2D\uFF0C\u4E0B\u8F09\u662F\u900F\u904E\u7522\u751F&lt;a&gt; link \u53BB\u505A\u4E0B\u8F09\u52D5\u4F5C\uFF0C\u9019\u6D41\u7A0B\u6703\u628A\u6A94\u6848\u4E0B\u8F09\u5230\u700F\u89BD\u5668\u9810\u8A2D\u7684\u5132\u5B58\u8DEF\u5F91\u3002</p><div class="language-javascript ext-js line-numbers-mode"><pre class="language-javascript"><code><span class="token keyword">const</span> link <span class="token operator">=</span> document<span class="token punctuation">.</span><span class="token function">createElement</span><span class="token punctuation">(</span><span class="token string">&quot;a&quot;</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
link<span class="token punctuation">.</span>href <span class="token operator">=</span> uri <span class="token operator">+</span> <span class="token function">base64</span><span class="token punctuation">(</span>workbookXML<span class="token punctuation">)</span><span class="token punctuation">;</span>
link<span class="token punctuation">.</span>download <span class="token operator">=</span> <span class="token string">&quot;Workbook.xls&quot;</span><span class="token punctuation">;</span>
link<span class="token punctuation">.</span>target <span class="token operator">=</span> <span class="token string">&quot;_blank&quot;</span><span class="token punctuation">;</span>
document<span class="token punctuation">.</span>body<span class="token punctuation">.</span><span class="token function">appendChild</span><span class="token punctuation">(</span>link<span class="token punctuation">)</span><span class="token punctuation">;</span>
link<span class="token punctuation">.</span><span class="token function">click</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
document<span class="token punctuation">.</span>body<span class="token punctuation">.</span><span class="token function">removeChild</span><span class="token punctuation">(</span>link<span class="token punctuation">)</span><span class="token punctuation">;</span>
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><p>\u800C\u4F7F\u7528 browser File System Access API\uFF0C\u53EF\u4EE5\u6307\u5B9A\u6A94\u6848\u5132\u5B58\u8DEF\u5F91\uFF0C\u4E5F\u53EF\u4EE5\u8B93\u4F7F\u7528\u8005\u81EA\u5DF1\u518D\u4FEE\u6539\u6A94\u6848\u540D\u7A31\u3002</p><div class="language-javascript ext-js line-numbers-mode"><pre class="language-javascript"><code><span class="token comment">//...</span>
<span class="token keyword">const</span> handle <span class="token operator">=</span> <span class="token keyword">await</span> window<span class="token punctuation">.</span><span class="token function">showSaveFilePicker</span><span class="token punctuation">(</span><span class="token punctuation">{</span>
    <span class="token literal-property property">suggestedName</span><span class="token operator">:</span> filename<span class="token punctuation">,</span>
    <span class="token literal-property property">types</span><span class="token operator">:</span> <span class="token punctuation">[</span>
      <span class="token punctuation">{</span>
        <span class="token literal-property property">description</span><span class="token operator">:</span> <span class="token string">&quot;Excel \u6A94\u6848&quot;</span><span class="token punctuation">,</span>
        <span class="token literal-property property">accept</span><span class="token operator">:</span> <span class="token punctuation">{</span><span class="token operator">...</span><span class="token punctuation">}</span><span class="token punctuation">,</span>
      <span class="token punctuation">}</span><span class="token punctuation">,</span>
    <span class="token punctuation">]</span><span class="token punctuation">,</span>
<span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">;</span>

<span class="token comment">// \u6A94\u6848\u8CC7\u6599\u5BEB\u5165\u6307\u5B9A\u4F4D\u7F6E</span>
<span class="token keyword">const</span> writableStream <span class="token operator">=</span> <span class="token keyword">await</span> handle<span class="token punctuation">.</span><span class="token function">createWritable</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token keyword">await</span> writableStream<span class="token punctuation">.</span><span class="token function">write</span><span class="token punctuation">(</span>blob<span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token keyword">await</span> writableStream<span class="token punctuation">.</span><span class="token function">close</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><h2 id="vue3-\u7248\u672C-excel-\u532F\u51FA-sample-code" tabindex="-1"><a class="header-anchor" href="#vue3-\u7248\u672C-excel-\u532F\u51FA-sample-code" aria-hidden="true">#</a> vue3 \u7248\u672C\uFF1Aexcel \u532F\u51FA sample code</h2><div class="language-javascript ext-js line-numbers-mode"><pre class="language-javascript"><code><span class="token operator">&lt;</span>script setup<span class="token operator">&gt;</span>
<span class="token keyword">import</span> <span class="token operator">*</span> <span class="token keyword">as</span> <span class="token constant">XLSX</span> <span class="token keyword">from</span> <span class="token string">&quot;xlsx&quot;</span><span class="token punctuation">;</span>

<span class="token keyword">const</span> <span class="token function-variable function">exportToExcel</span> <span class="token operator">=</span> <span class="token keyword">async</span> <span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token operator">=&gt;</span> <span class="token punctuation">{</span>
  <span class="token keyword">const</span> filename <span class="token operator">=</span> <span class="token string">&quot;\u7528\u6236\u6578\u64DA&quot;</span><span class="token punctuation">;</span>

  <span class="token comment">// \u5275\u5EFA\u5DE5\u4F5C\u7C3F</span>
  <span class="token keyword">const</span> workbook <span class="token operator">=</span> <span class="token constant">XLSX</span><span class="token punctuation">.</span>utils<span class="token punctuation">.</span><span class="token function">book_new</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>

  <span class="token comment">// \u5275\u5EFA\u5DE5\u4F5C\u8868</span>
  <span class="token keyword">const</span> worksheet <span class="token operator">=</span> <span class="token constant">XLSX</span><span class="token punctuation">.</span>utils<span class="token punctuation">.</span><span class="token function">aoa_to_sheet</span><span class="token punctuation">(</span><span class="token punctuation">[</span>
    <span class="token punctuation">[</span><span class="token string">&quot;\u59D3\u540D&quot;</span><span class="token punctuation">,</span> <span class="token string">&quot;\u5E74\u9F61&quot;</span><span class="token punctuation">]</span><span class="token punctuation">,</span>
    <span class="token punctuation">[</span><span class="token string">&quot;John Doe&quot;</span><span class="token punctuation">,</span> <span class="token number">30</span><span class="token punctuation">]</span><span class="token punctuation">,</span>
    <span class="token punctuation">[</span><span class="token string">&quot;Jane Smith&quot;</span><span class="token punctuation">,</span> <span class="token number">25</span><span class="token punctuation">]</span><span class="token punctuation">,</span>
    <span class="token punctuation">[</span><span class="token string">&quot;Bob Johnson&quot;</span><span class="token punctuation">,</span> <span class="token number">35</span><span class="token punctuation">]</span><span class="token punctuation">,</span>
  <span class="token punctuation">]</span><span class="token punctuation">)</span><span class="token punctuation">;</span>

  <span class="token comment">// \u5C07\u5DE5\u4F5C\u8868\u6DFB\u52A0\u5230\u5DE5\u4F5C\u7C3F</span>
  <span class="token constant">XLSX</span><span class="token punctuation">.</span>utils<span class="token punctuation">.</span><span class="token function">book_append_sheet</span><span class="token punctuation">(</span>workbook<span class="token punctuation">,</span> worksheet<span class="token punctuation">,</span> filename<span class="token punctuation">)</span><span class="token punctuation">;</span>

  <span class="token comment">// \u5C07\u5DE5\u4F5C\u7C3F\u8F49\u63DB\u70BAExcel\u6587\u4EF6\u5C0D\u8C61</span>
  <span class="token keyword">const</span> excelBuffer <span class="token operator">=</span> <span class="token constant">XLSX</span><span class="token punctuation">.</span><span class="token function">write</span><span class="token punctuation">(</span>workbook<span class="token punctuation">,</span> <span class="token punctuation">{</span> <span class="token literal-property property">bookType</span><span class="token operator">:</span> <span class="token string">&quot;xlsx&quot;</span><span class="token punctuation">,</span> <span class="token literal-property property">type</span><span class="token operator">:</span> <span class="token string">&quot;array&quot;</span> <span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">;</span>

  <span class="token comment">// \u5275\u5EFABlob\u5C0D\u8C61</span>
  <span class="token keyword">const</span> blob <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">Blob</span><span class="token punctuation">(</span><span class="token punctuation">[</span>excelBuffer<span class="token punctuation">]</span><span class="token punctuation">,</span> <span class="token punctuation">{</span>
    <span class="token literal-property property">type</span><span class="token operator">:</span> <span class="token string">&quot;application/vnd.openxmlformats-officedocument.spreadsheetml.sheet&quot;</span><span class="token punctuation">,</span>
  <span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">;</span>

  <span class="token keyword">const</span> handle <span class="token operator">=</span> <span class="token keyword">await</span> window<span class="token punctuation">.</span><span class="token function">showSaveFilePicker</span><span class="token punctuation">(</span><span class="token punctuation">{</span>
    <span class="token literal-property property">suggestedName</span><span class="token operator">:</span> filename<span class="token punctuation">,</span>
    <span class="token literal-property property">types</span><span class="token operator">:</span> <span class="token punctuation">[</span>
      <span class="token punctuation">{</span>
        <span class="token literal-property property">description</span><span class="token operator">:</span> <span class="token string">&quot;Excel \u6A94\u6848&quot;</span><span class="token punctuation">,</span>
        <span class="token literal-property property">accept</span><span class="token operator">:</span> <span class="token punctuation">{</span>
          <span class="token string-property property">&quot;application/vnd.openxmlformats-officedocument.spreadsheetml.sheet&quot;</span><span class="token operator">:</span> <span class="token punctuation">[</span>
            <span class="token string">&quot;.xlsx&quot;</span><span class="token punctuation">,</span>
          <span class="token punctuation">]</span><span class="token punctuation">,</span>
        <span class="token punctuation">}</span><span class="token punctuation">,</span>
      <span class="token punctuation">}</span><span class="token punctuation">,</span>
    <span class="token punctuation">]</span><span class="token punctuation">,</span>
  <span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">;</span>

  console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span>handle<span class="token punctuation">)</span><span class="token punctuation">;</span>
  console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span>blob<span class="token punctuation">)</span><span class="token punctuation">;</span>

  <span class="token comment">// \u6A94\u6848\u8CC7\u6599\u5BEB\u5165\u6307\u5B9A\u4F4D\u7F6E</span>
  <span class="token keyword">const</span> writableStream <span class="token operator">=</span> <span class="token keyword">await</span> handle<span class="token punctuation">.</span><span class="token function">createWritable</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
  <span class="token keyword">await</span> writableStream<span class="token punctuation">.</span><span class="token function">write</span><span class="token punctuation">(</span>blob<span class="token punctuation">)</span><span class="token punctuation">;</span>
  <span class="token keyword">await</span> writableStream<span class="token punctuation">.</span><span class="token function">close</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span><span class="token punctuation">;</span>
<span class="token operator">&lt;</span><span class="token operator">/</span>script<span class="token operator">&gt;</span>

<span class="token operator">&lt;</span>template<span class="token operator">&gt;</span>
  <span class="token operator">&lt;</span>div<span class="token operator">&gt;</span>
    <span class="token operator">&lt;</span>button @click<span class="token operator">=</span><span class="token string">&quot;exportToExcel&quot;</span><span class="token operator">&gt;</span>\u532F\u51FA Excel<span class="token operator">&lt;</span><span class="token operator">/</span>button<span class="token operator">&gt;</span>
  <span class="token operator">&lt;</span><span class="token operator">/</span>div<span class="token operator">&gt;</span>
<span class="token operator">&lt;</span><span class="token operator">/</span>template<span class="token operator">&gt;</span>

<span class="token operator">&lt;</span>style lang<span class="token operator">=</span><span class="token string">&quot;scss&quot;</span><span class="token operator">&gt;</span>
button <span class="token punctuation">{</span>
  @apply p<span class="token operator">-</span><span class="token number">4</span> font<span class="token operator">-</span>bold text<span class="token operator">-</span>3xl tracking<span class="token operator">-</span>wide shadow<span class="token operator">-</span>md<span class="token punctuation">;</span>
<span class="token punctuation">}</span>
<span class="token operator">&lt;</span><span class="token operator">/</span>style<span class="token operator">&gt;</span>
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div>`,8),o=[e];function c(l,i){return s(),a("div",null,o)}const r=n(p,[["render",c],["__file","useFileSystemAccessAPI.html.vue"]]);export{r as default};
